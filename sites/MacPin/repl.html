<html>
<head>
	<title>MacPin REPL: app.js</title>
</head>
<body>
	<form onsubmit="return false;">
		<textarea id="output" readonly cols=80 rows=25></textarea>
		<br />
		<!-- <input id="command" placeholder="Enter command" autofocus> -->
		<p id="command2" contenteditable>//Enter Command</p>
		<input type="submit" value="Execute">
	</form>
	<script>
		function evalREPL(e) {
			//var command = document.getElementById('command').value;
			var command = document.getElementById('command2').innerText; // newlines? ASI?
			command = command.replace(/[\u2018\u2019\u201A]/g, "\'"); // fix smart single quotes and apostrophe
			command = command.replace(/[\u201C\u201D\u201E]/g, "\""); // fix smart double quotes
			document.getElementById('output').value += '>> ' + command + '\n';
			webkit.messageHandlers.evalREPL.postMessage(command);
			//document.getElementById('command').value = null;
		}
		function returnREPL(result) {
			//document.getElementbyId('output').value += e.detail.result;
			//result = JSON.parse(result);
			document.getElementById('output').value += unescape(result) + '\n';
		}
		document.addEventListener('submit', evalREPL, true);
	</script>
</body>
</html>
